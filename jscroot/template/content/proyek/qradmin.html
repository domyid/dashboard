<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Admin Control</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        .container {
            max-width: 800px;
            margin-top: 50px;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-active {
            background-color: #23d160;
            animation: pulse 2s infinite;
        }
        .status-inactive {
            background-color: #ff3860;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .qr-display {
            text-align: center;
            padding: 2rem;
            border: 2px dashed #dbdbdb;
            border-radius: 12px;
            background-color: #f5f5f5;
            margin: 1rem 0;
        }
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            margin: 1rem 0;
        }
        .stats-number {
            font-size: 3rem;
            font-weight: bold;
            display: block;
        }
        .countdown {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3273dc;
            margin: 0.5rem 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="box">
            <h1 class="title has-text-centered">üéõÔ∏è QR Code Admin Control Panel</h1>
            <p class="subtitle has-text-centered has-text-grey">Kelola sistem QR code claim bimbingan</p>
            
            <!-- System Status -->
            <div class="notification" id="system-status">
                <span class="status-indicator" id="status-indicator"></span>
                <strong>Status Sistem: </strong>
                <span id="status-text">Memuat...</span>
                <span class="is-pulled-right">
                    <small id="last-updated"></small>
                </span>
            </div>

            <!-- Control Buttons -->
            <div class="field is-grouped is-grouped-centered mb-5">
                <div class="control">
                    <button class="button is-large is-success" id="startBtn">
                        <span class="icon">
                            <span>üü¢</span>
                        </span>
                        <span>Start QR Session</span>
                    </button>
                </div>
                <div class="control">
                    <button class="button is-large is-danger" id="stopBtn">
                        <span class="icon">
                            <span>üî¥</span>
                        </span>
                        <span>Stop QR Session</span>
                    </button>
                </div>
            </div>

            <!-- Current QR Code Display -->
            <div id="qr-display" class="qr-display" style="display: none;">
                <h3 class="subtitle">üì± Current QR Code</h3>
                <canvas id="currentQR" width="200" height="200"></canvas>
                <div class="countdown" id="countdown">‚è±Ô∏è Loading...</div>
                <div class="field">
                    <label class="label">QR Code Text:</label>
                    <input class="input" type="text" id="qr-text" readonly>
                </div>
                <p class="has-text-grey">QR code refresh otomatis setiap 20 detik</p>
            </div>

            <!-- Statistics -->
            <div class="columns">
                <div class="column">
                    <div class="stats-card">
                        <span class="stats-number" id="total-claims">0</span>
                        <span>Total Claims</span>
                    </div>
                </div>
                <div class="column">
                    <div class="stats-card">
                        <span class="stats-number" id="active-sessions">0</span>
                        <span>Active Sessions</span>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="box">
                <h3 class="subtitle">üìä Recent Activity</h3>
                <div id="recent-activity">
                    <p class="has-text-grey">Loading activity...</p>
                </div>
                <div class="field">
                    <div class="control">
                        <button class="button is-info" id="refreshStats">
                            <span class="icon">üîÑ</span>
                            <span>Refresh Statistics</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Instructions -->
            <div class="content">
                <h3>üìã Instruksi Penggunaan:</h3>
                <ol>
                    <li><strong>Start QR Session:</strong> Aktifkan sistem QR code untuk memulai sesi claim</li>
                    <li><strong>Monitor:</strong> Pantau QR code yang sedang aktif dan statistik real-time</li>
                    <li><strong>Stop QR Session:</strong> Hentikan sistem QR code untuk mengakhiri sesi</li>
                </ol>
                
                <h4>‚ö†Ô∏è Catatan Penting:</h4>
                <ul>
                    <li>QR code otomatis refresh setiap 20 detik</li>
                    <li>Setiap user hanya bisa claim 1x seumur hidup</li>
                    <li>Claims akan tercatat di database untuk tracking</li>
                    <li>Hanya admin yang dapat mengontrol sistem ini</li>
                </ul>
            </div>

            <!-- Error/Success Notifications -->
            <div class="notification is-danger is-light mt-5" id="errorNotification" style="display: none;">
                <button class="delete" id="closeError"></button>
                <span id="errorMessage"></span>
            </div>

            <div class="notification is-success is-light mt-5" id="successNotification" style="display: none;">
                <button class="delete" id="closeSuccess"></button>
                <span id="successMessage"></span>
            </div>
        </div>
    </div>

    <script type="module" src="qradmin.js"></script>
</body>
</html>